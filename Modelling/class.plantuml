@startuml
skinparam style strictuml
skinparam classAttributeIconSize 0

package "Core Proxy" {
    class ProxyServer {
        +start()
        +stop()
        +handleConnection()
        +forwardRequest()
        +forwardResponse()
        -socketListener
        -interceptEnabled : bool
    }

    class Interceptor {
        +enable()
        +disable()
        +interceptPacket(packet)
        +applyRules(packet)
    }

    class PacketSniffer {
        +startSniff()
        +stopSniff()
        +onPacket(packet)
    }
}

package "HTTP Processing" {
    class HTTPMessage {
        +headers : dict
        +body : string
        +raw : bytes
        +parse()
        +rebuild()
    }

    class Request extends HTTPMessage {}
    class Response extends HTTPMessage {}

    class RequestModifier {
        +modifyHeaders()
        +modifyBody()
        +drop()
        +mark()
    }
}

package "UI / Management" {
    class HistoryLog {
        +addEntry()
        +getAll()
        +filter()
    }

    class BookmarkManager {
        +addBookmark()
        +removeBookmark()
        +listBookmarks()
    }

    class ListManager {
        +addList()
        +modifyList()
        +deleteList()
        +getList()
    }
}

package "Payload Engine" {
    class PayloadList {
        +name : string
        +items : List<string>
        +load()
    }

    class IntruderEngine {
        +executePayloads(request, payloadList)
        +generateRequests()
    }
}

package "Domain/URL Filtering" {
    class DomainBlockList {
        +isBlocked(url)
    }
}

' Relationships
ProxyServer --> Interceptor
ProxyServer --> PacketSniffer
ProxyServer --> Request
ProxyServer --> Response

Interceptor --> DomainBlockList
Interceptor --> RequestModifier

PacketSniffer --> ProxyServer : notify

HistoryLog --> Request
HistoryLog --> Response

BookmarkManager --> Request
BookmarkManager --> Response

ListManager --> PayloadList
ListManager --> DomainBlockList

IntruderEngine --> PayloadList
IntruderEngine --> Request

@enduml
